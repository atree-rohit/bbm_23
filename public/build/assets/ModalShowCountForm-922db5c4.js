import{m as h,_ as f,c as o,b as s,F as r,l as u,d as c,n as b,o as l,t as _}from"./_plugin-vue_export-helper-47d1f91b.js";const p={name:"ModalShowCountForm",props:{show:{type:Boolean,default:!1},form_data:{type:Object,default:()=>{}}},emits:["close"],data(){return{fields:{form:["id","name","affiliation","phone","email","team_members","open_access","location","state","district","latitude","longitude","date","start_time","end_time","altitude","distance","weather","photo_link","status","comments"],species:["id","common_name","scientific_name","individuals","remarks","status"]},statuses:["pending","approved","duplicate","rejected"]}},created(){console.log(this.form_data)},computed:{...h({is_super_admin:e=>e.auth.is_super_admin,is_admin:e=>e.auth.is_admin,user:e=>e.auth.user}),admin(){return this.is_super_admin||this.is_admin},unvalidated_species_flag(){const e=[...new Set(this.form_data.species_list.map(a=>a.status))];return e.length==1&&e[0]=="approved"}},methods:{formClassColor(){let e="danger";return this.form_data.status=="approved"&&(e="info"),e},speciesTableClassColor(){return this.unvalidated_species_flag?"bg-success":"bg-danger"},speciesTableRowColor(e){let a="table-secondary";switch(e.status){case"pending":a="table-primary";break;case"approved":a="table-success";break;case"duplicate":a="table-warning";break;case"rejected":a="table-danger";break}return a},setSpeciesStatus(e,a){let i={species_id:e.id,status:a};this.$store.dispatch("count_forms/setSpeciesStatus",i)},setFormStatus(e){let a={form_id:this.form_data.id,status:e};this.$store.dispatch("count_forms/setFormStatus",a)},validateAllSpecies(){this.form_data.species_list.filter(e=>e.status=="pending").forEach(e=>this.setSpeciesStatus(e,"approved"))},async deleteForm(){confirm("Are you sure you want to delete this Form?")&&(this.$emit("close"),await this.$store.dispatch("count_forms/deleteForm",this.form_data))},closeModal(){this.$emit("close")}}},C={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},y={class:"modal-dialog modal-xl"},k={class:"modal-content"},v={class:"modal-header"},g={key:0,class:"border border-success text-center m-1 p-2 w-75"},x={class:"d-flex justify-content-center"},S=["textContent","onClick"],w={class:"mx-2"},F={class:"mx-2"},M={class:"modal-body"},A={class:"table-container"},j={class:"table table-sm form-table"},B=["textContent"],T=["textContent"],V={class:"table-container"},D={class:"table table-sm species-table"},E=["textContent"],N={key:0,class:"bg-dark"},R=["textContent"],z={key:0,class:"d-flex justify-content-around bg-secondary"},I=["textContent","onClick"],L={class:"modal-footer"},O={key:1,class:"modal-backdrop fade show"};function q(e,a,i,G,m,n){return l(),o(r,null,[i.show?(l(),o("div",C,[s("div",y,[s("div",k,[s("div",v,[n.admin?(l(),o("div",g,[s("div",x,[(l(!0),o(r,null,u(m.statuses,t=>(l(),o("div",{key:t,class:"mx-2"},[t!=i.form_data.status?(l(),o("button",{key:0,class:"btn btn-success btn-sm",textContent:_(t),onClick:d=>n.setFormStatus(t)},null,8,S)):c("",!0)]))),128)),s("div",w,[s("button",{class:"btn btn-success",onClick:a[0]||(a[0]=(...t)=>n.validateAllSpecies&&n.validateAllSpecies(...t))},"Validate All Species")]),s("div",F,[s("button",{class:"btn btn-danger",onClick:a[1]||(a[1]=(...t)=>n.deleteForm&&n.deleteForm(...t))},"Delete Form")])])])):c("",!0),s("button",{type:"button",class:"btn-close",onClick:a[2]||(a[2]=(...t)=>n.closeModal&&n.closeModal(...t))})]),s("div",M,[s("div",A,[s("table",j,[s("tbody",null,[(l(!0),o(r,null,u(m.fields.form,t=>(l(),o("tr",{key:t},[s("th",{textContent:_(t),class:b(`bg-${n.formClassColor()}`)},null,10,B),s("td",{textContent:_(i.form_data[t]),class:b(`table-${n.formClassColor()}`)},null,10,T)]))),128))])])]),s("div",V,[s("table",D,[s("thead",{class:b(["text-light",n.speciesTableClassColor()])},[s("tr",null,[(l(!0),o(r,null,u(m.fields.species,t=>(l(),o("th",{key:t,textContent:_(t)},null,8,E))),128)),n.admin?(l(),o("th",N," Actions ")):c("",!0)])],2),s("tbody",null,[(l(!0),o(r,null,u(i.form_data.species_list,t=>(l(),o("tr",{key:t.id,class:b(n.speciesTableRowColor(t))},[(l(!0),o(r,null,u(m.fields.species,d=>(l(),o("td",{key:d,textContent:_(t[d])},null,8,R))),128)),n.admin?(l(),o("td",z,[(l(!0),o(r,null,u(m.statuses,d=>(l(),o("div",{key:d},[d!=t.status?(l(),o("button",{key:0,class:"btn btn-success btn-sm",textContent:_(d),onClick:H=>n.setSpeciesStatus(t,d)},null,8,I)):c("",!0)]))),128))])):c("",!0)],2))),128))])])])]),s("div",L,[s("button",{type:"button",class:"btn btn-secondary",onClick:a[3]||(a[3]=(...t)=>n.closeModal&&n.closeModal(...t))},"Close")])])])])):c("",!0),i.show?(l(),o("div",O)):c("",!0)],64)}const K=f(p,[["render",q],["__scopeId","data-v-5cd0f1a9"]]);export{K as M};

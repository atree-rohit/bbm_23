import{m as C,_ as v,c as e,b as a,F as c,j as i,d as u,n as p,o as s,t as _,p as k,i as g,s as f,r as x,k as F,h as w,f as S}from"./_plugin-vue_export-helper-13c6137d.js";const A={name:"ModalShowCountForm",props:{show:{type:Boolean,default:!1},form_data:{type:Object,default:()=>{}}},emits:["close"],data(){return{fields:{form:["name","affiliation","phone","email","team_members","open_access","location","state","district","latitude","longitude","date","start_time","end_time","altitude","distance","weather","photo_link","status","comments"],species:["common_name","scientific_name","individuals","remarks","status"]},statuses:["pending","approved","duplicate","rejected"]}},computed:{...C({is_super_admin:t=>t.auth.is_super_admin,is_admin:t=>t.auth.is_admin,user:t=>t.auth.user}),admin(){return this.is_super_admin||this.is_admin},unvalidated_species_flag(){const t=[...new Set(this.form_data.species_list.map(d=>d.status))];return t.length==1&&t[0]=="approved"}},methods:{formClassColor(){let t="danger";return this.form_data.status=="approved"&&(t="info"),t},speciesTableClassColor(){return this.unvalidated_species_flag?"bg-success":"bg-danger"},speciesTableRowColor(t){return t.status=="approved"?"table-success":"table-danger"},setSpeciesStatus(t,d){let m={species_id:t.id,status:d};this.$store.dispatch("count_forms/setSpeciesStatus",m)},setFormStatus(t){let d={form_id:this.form_data.id,status:t};this.$store.dispatch("count_forms/setFormStatus",d)},validateAllSpecies(){this.form_data.species_list.filter(t=>t.status=="pending").forEach(t=>this.setSpeciesStatus(t,"approved"))},async deleteForm(){confirm("Are you sure you want to delete this Form?")&&(this.$emit("close"),await this.$store.dispatch("count_forms/deleteForm",this.form_data))},closeModal(){this.$emit("close")}}},M=t=>(k("data-v-8a130689"),t=t(),g(),t),D={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},I={class:"modal-dialog modal-xl"},V={class:"modal-content"},j={class:"modal-header"},B={key:0,class:"border border-success text-center m-1 p-2 w-75"},T={class:"d-flex justify-content-center"},N=["textContent","onClick"],E={class:"mx-2"},R={class:"mx-2"},z={class:"modal-body"},L={class:"table table-sm form-table"},O=["textContent"],q=["textContent"],G={class:"table table-sm species-table"},H=["textContent"],J=M(()=>a("th",{class:"bg-dark"},"Actions",-1)),K=["textContent"],P={key:0,class:"d-flex justify-content-around bg-secondary"},Q=["textContent","onClick"],U={class:"modal-footer"},W={key:1,class:"modal-backdrop fade show"};function X(t,d,m,y,r,n){return s(),e(c,null,[m.show?(s(),e("div",D,[a("div",I,[a("div",V,[a("div",j,[n.admin?(s(),e("div",B,[a("div",T,[(s(!0),e(c,null,i(r.statuses,o=>(s(),e("div",{key:o,class:"mx-2"},[o!=m.form_data.status?(s(),e("button",{key:0,class:"btn btn-success btn-sm",textContent:_(o),onClick:l=>n.setFormStatus(o)},null,8,N)):u("",!0)]))),128)),a("div",E,[a("button",{class:"btn btn-success",onClick:d[0]||(d[0]=(...o)=>n.validateAllSpecies&&n.validateAllSpecies(...o))},"Validate All Species")]),a("div",R,[a("button",{class:"btn btn-danger",onClick:d[1]||(d[1]=(...o)=>n.deleteForm&&n.deleteForm(...o))},"Delete Form")])])])):u("",!0),a("button",{type:"button",class:"btn-close",onClick:d[2]||(d[2]=(...o)=>n.closeModal&&n.closeModal(...o))})]),a("div",z,[a("table",L,[a("tbody",null,[(s(!0),e(c,null,i(r.fields.form,o=>(s(),e("tr",{key:o},[a("th",{textContent:_(o),class:p(`bg-${n.formClassColor()}`)},null,10,O),a("td",{textContent:_(m.form_data[o]),class:p(`table-${n.formClassColor()}`)},null,10,q)]))),128))])]),a("table",G,[a("thead",{class:p(["text-light",n.speciesTableClassColor()])},[a("tr",null,[(s(!0),e(c,null,i(r.fields.species,o=>(s(),e("th",{key:o,textContent:_(o)},null,8,H))),128)),J])],2),a("tbody",null,[(s(!0),e(c,null,i(m.form_data.species_list,o=>(s(),e("tr",{key:o.id,class:p(n.speciesTableRowColor(o))},[(s(!0),e(c,null,i(r.fields.species,l=>(s(),e("td",{key:l,textContent:_(o[l])},null,8,K))),128)),n.admin?(s(),e("td",P,[(s(!0),e(c,null,i(r.statuses,l=>(s(),e("div",{key:l},[l!=o.status?(s(),e("button",{key:0,class:"btn btn-success btn-sm",textContent:_(l),onClick:h=>n.setSpeciesStatus(o,l)},null,8,Q)):u("",!0)]))),128))])):u("",!0)],2))),128))])])]),a("div",U,[a("button",{type:"button",class:"btn btn-secondary",onClick:d[3]||(d[3]=(...o)=>n.closeModal&&n.closeModal(...o))},"Close")])])])])):u("",!0),m.show?(s(),e("div",W)):u("",!0)],64)}const Y=v(A,[["render",X],["__scopeId","data-v-8a130689"]]);const Z={name:"ValidateForms",components:{ModalShowCountForm:Y},data(){return{headers:["name","location","state","district","latitude","longitude","no_of_species","date","start_time","end_time","status"],statuses:["all","pending","approved","rejected","duplicate"],selected_status:"all",showModal:!1,selectedFormID:-1}},computed:{...C({user:t=>t.auth.user,is_super_admin:t=>t.auth.is_super_admin,all_data:t=>t.count_forms.all_data}),filtered_data(){let t=[];return this.all_data.forEach(d=>{d.date.includes("2023-09")&&t.push({...d,no_of_species:d.species_list.length})}),this.selected_status!="all"&&(t=t.filter(d=>d.status==this.selected_status)),t},selected_form(){return this.selectedFormID==-1?{}:this.all_data.find(t=>t.id==this.selectedFormID)}},watch:{},mounted(){f.dispatch("count_forms/getAllData")},methods:{selectForm(t){this.selectedFormID=t,this.showModal=!0},showApproveBtn(t){return t.status=="pending"},showDeleteBtn(t){return t.status!="approved"},async approveForm(t){confirm("Are you sure you want to Approve this Form?")&&await f.dispatch("count_forms/approveForm",t)},async deleteForm(t){confirm("Are you sure you want to delete this Form?")&&await f.dispatch("count_forms/deleteForm",t)},closeModal(){this.selectedForm={},this.showModal=!1}}},$={class:"container-fluid validate-forms-container"},tt={class:"d-flex justify-content-center bg-dark p-2"},et=["textContent","onClick"],st={class:"table table-sm"},ot={class:"bg-success text-warning"},at=["textContent"],nt={key:0},lt={class:"table-secondary"},dt=["textContent","onClick"],rt={key:0,class:"bg-secondary d-flex justify-content-around"},ct=["onClick"],it=["onClick"];function ut(t,d,m,y,r,n){const o=x("modal-show-count-form");return s(),e(c,null,[a("div",$,[a("div",tt,[(s(!0),e(c,null,i(r.statuses,l=>(s(),e("button",{key:l,class:p(["btn btn-sm",l==r.selected_status?"btn-success":"btn-outline-success bg-light"]),textContent:_(l),onClick:h=>r.selected_status=l},null,10,et))),128))]),a("table",st,[a("thead",ot,[a("tr",null,[(s(!0),e(c,null,i(r.headers,l=>(s(),e("th",{key:l,textContent:_(l)},null,8,at))),128)),t.is_super_admin?(s(),e("th",nt,"Actions")):u("",!0)])]),a("tbody",lt,[(s(!0),e(c,null,i(n.filtered_data,l=>(s(),e("tr",{key:l.id},[(s(!0),e(c,null,i(r.headers,h=>(s(),e("td",{key:h,textContent:_(l[h]),onClick:mt=>n.selectForm(l.id)},null,8,dt))),128)),t.is_super_admin?(s(),e("td",rt,[n.showApproveBtn(l)?(s(),e("button",{key:0,class:"btn btn-sm btn-success",onClick:h=>n.approveForm(l)}," Approve ",8,ct)):u("",!0),w(" Â  "),n.showDeleteBtn(l)?(s(),e("button",{key:1,class:"btn btn-sm btn-danger",onClick:h=>n.deleteForm(l)}," Delete ",8,it)):u("",!0)])):u("",!0)]))),128))])])]),F(o,{show:r.showModal,form_data:n.selected_form,onClose:n.closeModal},null,8,["show","form_data","onClose"])],64)}const _t=v(Z,[["render",ut],["__scopeId","data-v-82100e6b"]]),b=S({});b.component("ValidateForms",_t);b.use(f);b.mount("#app");

import{_ as C,c as i,w as h,v as f,b as o,z as U,t as m,F as p,i as y,d as u,o as l,m as F,s as v,r as x,n as g,l as k,p as w,k as A,h as E,j as N,f as T}from"./_plugin-vue_export-helper-b37af2af.js";import{d as D}from"./districts-fe2f3589.js";const L={name:"AutoComplete",props:{question:{type:Object,required:!0},suggestions:{type:Array,required:!0},value:{type:String,required:!0}},emits:["selected"],data(){return{searchText:"",showSuggestions:!1,filteredSuggestions:[]}},watch:{value(e){this.searchText=e}},methods:{handleInput(){this.searchText.length>=1?(this.filteredSuggestions=this.suggestions.filter(e=>e.toLowerCase().includes(this.searchText.toLowerCase())),this.showSuggestions=!0):(this.filteredSuggestions=[],this.showSuggestions=!1)},selectSuggestion(e){this.searchText=e,this.showSuggestions=!1,this.$emit("selected",e)}}},j=["placeholder"],W=["for","textContent"],O={key:0},P=["onClick"];function z(e,t,d,S,n,a){var _;return l(),i(p,null,[h(o("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=c=>n.searchText=c),placeholder:`Enter ${(_=d.question)==null?void 0:_.name}`,class:"form-control",onInput:t[1]||(t[1]=(...c)=>a.handleInput&&a.handleInput(...c)),onKeydown:t[2]||(t[2]=U((...c)=>a.selectSuggestion&&a.selectSuggestion(...c),["enter"]))},null,40,j),[[f,n.searchText]]),o("label",{for:d.question.name,class:"font-weight-bold",textContent:m(d.question.label)},null,8,W),n.showSuggestions?(l(),i("ul",O,[(l(!0),i(p,null,y(n.filteredSuggestions,(c,b)=>(l(),i("li",{key:b,onClick:s=>a.selectSuggestion(c)},m(c),9,P))),128))])):u("",!0)],64)}const K=C(L,[["render",z],["__scopeId","data-v-e54895dc"]]);const G={name:"CountForm",components:{AutoComplete:K},data(){return{tabs:[{label:"User",value:"user_details"},{label:"Location",value:"location_details"},{label:"Checklist",value:"species_list"}],current_tab:"user_details",form_data:{},species_list:[],current_species:{},states:[]}},computed:{...F({quiestions:e=>e.butterfly_counts.quiestions,species_lists:e=>e.butterfly_counts.species_lists,scientific_names:e=>e.butterfly_counts.scientific_names,common_names:e=>e.butterfly_counts.common_names,latitude:e=>e.locations.latitude,longitude:e=>e.locations.longitude}),page_questions(){let e=[];return e.push(this.quiestions.filter(t=>t.page==0)),e.push(this.quiestions.filter(t=>t.page==1)),e.push(this.quiestions.filter(t=>t.page==2)),console.log(11,e),e},completed(){let e={user_details:!0,location_details:!0,species_list:!0};return this.page_questions[0].filter(t=>t.required).map(t=>{this.form_data[t.name]==""&&(e.user_details=!1)}),this.page_questions[1].filter(t=>t.required).map(t=>{this.form_data[t.name]==""&&(e.location_details=!1)}),this.species_list.length==0&&(e.species_list=!1),e},current_species_completed(){var e,t;return((e=this.current_species.common_name)==null?void 0:e.length)>3||((t=this.current_species.scientific_name)==null?void 0:t.length)>3},form_completed(){return this.completed.user_details&&this.completed.location_details&&this.completed.species_list}},watch:{latitude(){this.form_data.coordinates=this.latitude+","+this.longitude},longitude(){this.form_data.coordinates=this.latitude+","+this.longitude}},created(){v.dispatch("locations/init"),v.dispatch("butterfly_counts/initNames"),this.initFormData()},methods:{initFormData(){let e="";this.page_questions[0].map(t=>{this.form_data[t.name]=t.required?e:null}),this.page_questions[1].map(t=>{this.form_data[t.name]=t.required?e:null}),this.form_data.date=new Date().toISOString().slice(0,10),this.form_data.start_time=new Date().toLocaleTimeString(),this.form_data.state="",this.states=[...new Set(D.features.map(t=>t.properties.state))],this.species_list=[],this.initCurrentSpecies()},initCurrentSpecies(){this.current_species={common_name:"",scientific_name:"",individuals:1,remarks:null}},tabClass(e){let t=this.current_tab==e.value?"active":"";switch(e.value){case"location_details":t+=this.completed.user_details?"":" disabled";break;case"species_list":t+=this.completed.location_details?"":" disabled";break}return t},tabClick(e){this.current_tab=e.value},stateSelected(e){this.form_data.state_name=e},commonNameSelected(e){this.current_species.common_name=e;let t=this.species_lists.synoptic.find(d=>d[1]==e);if(t){this.current_species.scientific_name=t[0];return}t=this.species_lists.ifb.find(d=>d[1]==e),t&&(this.current_species.scientific_name=t[0])},scientificNameSelected(e){this.current_species.scientific_name=e;let t=this.species_lists.synoptic.find(d=>d[0]==e);if(t){this.current_species.common_name=t[1];return}t=this.species_lists.ifb.find(d=>d[0]==e),t&&(this.current_species.common_name=t[1])},decreaseIndividuals(){this.current_species.individuals>0&&this.current_species.individuals--},addSpecies(){const e=Object.assign({},this.current_species);console.log(e),this.species_list.push(e),this.initCurrentSpecies()},deleteSpecies(e){confirm("Are you sure you want to delete this species?")&&this.species_list.splice(e,1)},getPoints(){v.dispatch("locations/getCurrentCoordinates")},submitForm(){let e={...this.form_data,species_list:this.species_list};v.dispatch("butterfly_counts/submitForm",e),this.initFormData()}}},I=e=>(w("data-v-785daf4f"),e=e(),A(),e),X={class:"container-fluid form-container"},Y={class:"nav nav-tabs"},H=["onClick","textContent"],J={class:"main-container"},Q={key:0,class:"questions-container"},R={key:0},Z=I(()=>o("h1",{class:"bg-danger"},"Species List",-1)),$={key:0,class:"table table-sm table-hover table-responsive border border-primary"},q=I(()=>o("thead",null,[o("tr",{class:"bg-info"},[o("th",null,"No."),o("th",null,"Common"),o("th",null,"Scientific"),o("th",null,"Individuals"),o("th",null,"Actions")])],-1)),ee={class:"table-info"},te=["textContent"],se=["textContent"],oe=["textContent"],ne=["textContent"],le=["onClick"],ie=["onUpdate:modelValue","placeholder"],ae=["onUpdate:modelValue","placeholder"],ce=["onUpdate:modelValue","placeholder"],re=["onUpdate:modelValue","placeholder"],de=["onUpdate:modelValue","placeholder"],ue={key:6,class:"my-auto"},_e=["for","textContent"],me=["onUpdate:modelValue","placeholder"],pe=["onUpdate:modelValue","placeholder"],he=["for","textContent"],fe={key:5,class:"my-auto"},be={class:"btns-section"};function ge(e,t,d,S,n,a){const _=x("auto-complete");return l(),i("div",X,[o("ul",Y,[(l(!0),i(p,null,y(n.tabs,c=>(l(),i("li",{class:"nav-item",key:c.value},[o("a",{class:g(["nav-link",a.tabClass(c)]),onClick:b=>a.tabClick(c),textContent:m(c.label),href:"#"},null,10,H)]))),128))]),o("div",J,[(l(!0),i(p,null,y(n.tabs,(c,b)=>(l(),i(p,{key:c.value},[c.value==n.current_tab?(l(),i("div",Q,[n.current_tab=="species_list"?(l(),i("div",R,[Z,n.species_list.length?(l(),i("table",$,[q,o("tbody",ee,[(l(!0),i(p,null,y(n.species_list,(s,r)=>(l(),i("tr",{key:r},[o("td",{textContent:m(r+1)},null,8,te),o("td",{textContent:m(s.common_name)},null,8,se),o("td",{textContent:m(s.scientific_name)},null,8,oe),o("td",{textContent:m(s.individuals)},null,8,ne),o("td",null,[o("button",{type:"button",class:"btn btn-danger btn-sm",textContent:"X",onClick:Oe=>a.deleteSpecies(r)},null,8,le)])]))),128))])])):u("",!0)])):u("",!0),(l(!0),i(p,null,y(a.page_questions[b],s=>(l(),i("div",{key:s.name,class:"form-floating mb-2"},[b<2?(l(),i(p,{key:0},[s.type=="text"?h((l(),i("input",{key:0,type:"text","onUpdate:modelValue":r=>n.form_data[s.name]=r,placeholder:`Enter ${s.name}`,class:"form-control"},null,8,ie)),[[f,n.form_data[s.name]]]):s.type=="textarea"?h((l(),i("textarea",{key:1,"onUpdate:modelValue":r=>n.form_data[s.name]=r,placeholder:`Enter ${s.name}`,class:"form-control"},null,8,ae)),[[f,n.form_data[s.name]]]):s.type=="date"?h((l(),i("input",{key:2,type:"date","onUpdate:modelValue":r=>n.form_data[s.name]=r,placeholder:`Enter ${s.name}`,class:"form-control"},null,8,ce)),[[f,n.form_data[s.name]]]):s.type=="time"?h((l(),i("input",{key:3,type:"time","onUpdate:modelValue":r=>n.form_data[s.name]=r,placeholder:`Enter ${s.name}`,class:"form-control"},null,8,re)),[[f,n.form_data[s.name]]]):u("",!0),s.type=="location"?h((l(),i("input",{key:4,type:"text","onUpdate:modelValue":r=>n.form_data[s.name]=r,placeholder:`Enter ${s.name}`,class:"form-control w-75"},null,8,de)),[[f,n.form_data[s.name]]]):s.type=="autocomplete_state"?(l(),k(_,{key:5,question:s,suggestions:n.states,value:n.form_data.state_name,onSelected:a.stateSelected},null,8,["question","suggestions","value","onSelected"])):u("",!0),s.type=="location"?(l(),i("div",ue,[o("button",{class:"btn btn-outline-success px-3 me-2",onClick:t[0]||(t[0]=(...r)=>a.getPoints&&a.getPoints(...r))},"Get Coordinates")])):u("",!0),s.type!="location"||s.type!="autocomplete_state"?(l(),i("label",{key:7,for:s.name,class:g(["font-weight-bold",{required:s.required}]),textContent:m(s.label)},null,10,_e)):u("",!0)],64)):(l(),i(p,{key:1},[s.type=="autocomplete_common"?(l(),k(_,{key:0,question:s,suggestions:e.common_names,value:n.current_species.common_name,onSelected:a.commonNameSelected},null,8,["question","suggestions","value","onSelected"])):s.type=="autocomplete_scientific"?(l(),k(_,{key:1,question:s,suggestions:e.scientific_names,value:n.current_species.scientific_name,onSelected:a.scientificNameSelected},null,8,["question","suggestions","value","onSelected"])):u("",!0),s.type=="increment"?h((l(),i("input",{key:2,type:"number","onUpdate:modelValue":r=>n.current_species[s.name]=r,placeholder:`Enter ${s.name}`,class:"form-control w-75"},null,8,me)),[[f,n.current_species[s.name]]]):s.type=="textarea"?h((l(),i("textarea",{key:3,"onUpdate:modelValue":r=>n.current_species[s.name]=r,placeholder:`Enter ${s.name}`,class:"form-control"},null,8,pe)),[[f,n.current_species[s.name]]]):u("",!0),s.type!="autocomplete_common"&&s.type!="autocomplete_scientific"?(l(),i("label",{key:4,for:s.name,class:g(["font-weight-bold",{required:s.required}]),textContent:m(s.label)},null,10,he)):u("",!0),s.type=="increment"?(l(),i("div",fe,[o("button",{class:"btn btn-outline-success px-3 me-2",onClick:t[1]||(t[1]=r=>n.current_species.individuals++)},"+"),o("button",{class:"btn btn-outline-success px-3",onClick:t[2]||(t[2]=(...r)=>a.decreaseIndividuals&&a.decreaseIndividuals(...r))},"-")])):u("",!0)],64))]))),128))])):u("",!0)],64))),128)),o("div",be,[n.current_tab=="species_list"?(l(),i("button",{key:0,class:g(["btn btn-lg",a.current_species_completed?"btn-success":"btn-disabled"]),onClick:t[3]||(t[3]=(...c)=>a.addSpecies&&a.addSpecies(...c))},"Add Species",2)):u("",!0),o("button",{class:g(["btn btn-lg",a.form_completed?"btn-success":"btn-disabled"]),onClick:t[4]||(t[4]=(...c)=>a.submitForm&&a.submitForm(...c))},"Submit Form",2)])])])}const ye=C(G,[["render",ge],["__scopeId","data-v-785daf4f"]]);const ve={name:"ModalAboutBBMApp",props:{show:{type:Boolean,default:!1}},emits:["close"],data(){return{}},methods:{closeModal(){this.$emit("close")}}},V=e=>(w("data-v-9f0eb0a6"),e=e(),A(),e),ke={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},Ce={class:"modal-dialog modal-lg"},Se={class:"modal-content"},xe={class:"modal-header"},we=V(()=>o("h3",{class:"modal-title",id:"exampleModalLiveLabel"},"About Butterfly Counts App",-1)),Ae=V(()=>o("div",{class:"modal-body"},null,-1)),Be={class:"modal-footer"},Ie={key:1,class:"modal-backdrop fade show"};function Ve(e,t,d,S,n,a){return l(),i(p,null,[d.show?(l(),i("div",ke,[o("div",Ce,[o("div",Se,[o("div",xe,[we,o("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(..._)=>a.closeModal&&a.closeModal(..._))})]),Ae,o("div",Be,[o("button",{type:"button",class:"btn btn-secondary",onClick:t[1]||(t[1]=(..._)=>a.closeModal&&a.closeModal(..._))},"Close")])])])])):u("",!0),d.show?(l(),i("div",Ie)):u("",!0)],64)}const Me=C(ve,[["render",Ve],["__scopeId","data-v-9f0eb0a6"]]);const Ue={name:"ButterflyCounts",components:{CountForm:ye,ModalAboutBBMApp:Me},data(){return{nav_links:[{label:"About",value:"about"},{label:"Add",value:"add"},{label:"Data",value:"data"}],current_nav:"add",show_about_modal:!1}},methods:{navClick(e){this.current_nav=e.value}}},M=e=>(w("data-v-b6669481"),e=e(),A(),e),Fe={class:"container-fluid app-container"},Ee={class:"button-container d-flex justify-content-around my-2"},Ne=M(()=>o("i",{class:"bi bi-info-circle"},null,-1)),Te=[Ne],De=M(()=>o("button",{class:"btn btn-outline-primary badge rounded-pill text-info",titl:"Your Data"},[o("i",{class:"bi bi-database"})],-1)),Le={class:"tabs"};function je(e,t,d,S,n,a){const _=x("count-form"),c=x("ModalAboutBBMApp");return l(),i("div",Fe,[E(m(n.show_about_modal)+" ",1),o("div",Ee,[o("button",{class:"btn btn-outline-primary badge rounded-pill text-info",title:"About",onClick:t[0]||(t[0]=b=>n.show_about_modal=!0)},Te),De]),o("div",Le,[n.current_nav=="add"?(l(),k(_,{key:0})):u("",!0)]),N(c,{show:n.show_about_modal,onClose:t[1]||(t[1]=b=>n.show_about_modal=!1)},null,8,["show"])])}const We=C(Ue,[["render",je],["__scopeId","data-v-b6669481"]]),B=T({});B.component("butterfly-counts",We);B.use(v);B.mount("#app");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(e=>{console.log("Service Worker registered with scope:",e.scope)}).catch(e=>{console.error("Service Worker registration failed:",e)})});

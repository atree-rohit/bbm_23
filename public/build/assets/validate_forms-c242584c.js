import{m as v,_ as k,c as s,b as o,F as i,l as _,d as c,q as p,o as e,t as m,p as x,i as F,s as b,k as y,u as w,y as S,n as A,h as M,f as B}from"./_plugin-vue_export-helper-ba2f819f.js";import{B as D}from"./ButterflyAnimation-c5f3f748.js";const I={name:"ModalShowCountForm",props:{show:{type:Boolean,default:!1},form_data:{type:Object,default:()=>{}}},emits:["close"],data(){return{fields:{form:["name","affiliation","phone","email","team_members","open_access","location","state","district","latitude","longitude","date","start_time","end_time","altitude","distance","weather","photo_link","status","comments"],species:["common_name","scientific_name","individuals","remarks","status"]},statuses:["pending","approved","duplicate","rejected"]}},computed:{...v({is_super_admin:t=>t.auth.is_super_admin,is_admin:t=>t.auth.is_admin,user:t=>t.auth.user}),admin(){return this.is_super_admin||this.is_admin},unvalidated_species_flag(){const t=[...new Set(this.form_data.species_list.map(l=>l.status))];return t.length==1&&t[0]=="approved"}},methods:{formClassColor(){let t="danger";return this.form_data.status=="approved"&&(t="info"),t},speciesTableClassColor(){return this.unvalidated_species_flag?"bg-success":"bg-danger"},speciesTableRowColor(t){return t.status=="approved"?"table-success":"table-danger"},setSpeciesStatus(t,l){let h={species_id:t.id,status:l};this.$store.dispatch("count_forms/setSpeciesStatus",h)},setFormStatus(t){let l={form_id:this.form_data.id,status:t};this.$store.dispatch("count_forms/setFormStatus",l)},validateAllSpecies(){this.form_data.species_list.filter(t=>t.status=="pending").forEach(t=>this.setSpeciesStatus(t,"approved"))},async deleteForm(){confirm("Are you sure you want to delete this Form?")&&(this.$emit("close"),await this.$store.dispatch("count_forms/deleteForm",this.form_data))},closeModal(){this.$emit("close")}}},V=t=>(x("data-v-8a130689"),t=t(),F(),t),j={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},T={class:"modal-dialog modal-xl"},N={class:"modal-content"},E={class:"modal-header"},R={key:0,class:"border border-success text-center m-1 p-2 w-75"},q={class:"d-flex justify-content-center"},z=["textContent","onClick"],L={class:"mx-2"},O={class:"mx-2"},G={class:"modal-body"},H={class:"table table-sm form-table"},J=["textContent"],K=["textContent"],P={class:"table table-sm species-table"},Q=["textContent"],U=V(()=>o("th",{class:"bg-dark"},"Actions",-1)),W=["textContent"],X={key:0,class:"d-flex justify-content-around bg-secondary"},Y=["textContent","onClick"],Z={class:"modal-footer"},$={key:1,class:"modal-backdrop fade show"};function tt(t,l,h,g,r,n){return e(),s(i,null,[h.show?(e(),s("div",j,[o("div",T,[o("div",N,[o("div",E,[n.admin?(e(),s("div",R,[o("div",q,[(e(!0),s(i,null,_(r.statuses,a=>(e(),s("div",{key:a,class:"mx-2"},[a!=h.form_data.status?(e(),s("button",{key:0,class:"btn btn-success btn-sm",textContent:m(a),onClick:u=>n.setFormStatus(a)},null,8,z)):c("",!0)]))),128)),o("div",L,[o("button",{class:"btn btn-success",onClick:l[0]||(l[0]=(...a)=>n.validateAllSpecies&&n.validateAllSpecies(...a))},"Validate All Species")]),o("div",O,[o("button",{class:"btn btn-danger",onClick:l[1]||(l[1]=(...a)=>n.deleteForm&&n.deleteForm(...a))},"Delete Form")])])])):c("",!0),o("button",{type:"button",class:"btn-close",onClick:l[2]||(l[2]=(...a)=>n.closeModal&&n.closeModal(...a))})]),o("div",G,[o("table",H,[o("tbody",null,[(e(!0),s(i,null,_(r.fields.form,a=>(e(),s("tr",{key:a},[o("th",{textContent:m(a),class:p(`bg-${n.formClassColor()}`)},null,10,J),o("td",{textContent:m(h.form_data[a]),class:p(`table-${n.formClassColor()}`)},null,10,K)]))),128))])]),o("table",P,[o("thead",{class:p(["text-light",n.speciesTableClassColor()])},[o("tr",null,[(e(!0),s(i,null,_(r.fields.species,a=>(e(),s("th",{key:a,textContent:m(a)},null,8,Q))),128)),U])],2),o("tbody",null,[(e(!0),s(i,null,_(h.form_data.species_list,a=>(e(),s("tr",{key:a.id,class:p(n.speciesTableRowColor(a))},[(e(!0),s(i,null,_(r.fields.species,u=>(e(),s("td",{key:u,textContent:m(a[u])},null,8,W))),128)),n.admin?(e(),s("td",X,[(e(!0),s(i,null,_(r.statuses,u=>(e(),s("div",{key:u},[u!=a.status?(e(),s("button",{key:0,class:"btn btn-success btn-sm",textContent:m(u),onClick:d=>n.setSpeciesStatus(a,u)},null,8,Y)):c("",!0)]))),128))])):c("",!0)],2))),128))])])]),o("div",Z,[o("button",{type:"button",class:"btn btn-secondary",onClick:l[3]||(l[3]=(...a)=>n.closeModal&&n.closeModal(...a))},"Close")])])])])):c("",!0),h.show?(e(),s("div",$)):c("",!0)],64)}const et=k(I,[["render",tt],["__scopeId","data-v-8a130689"]]);const st={name:"ValidateForms",components:{ModalShowCountForm:et,ButterflyAnimation:D},data(){return{headers:["name","location","state","district","latitude","longitude","no_of_species","date","start_time","end_time","status"],statuses:["all","pending","approved","rejected","duplicate"],selected_status:"all",showModal:!1,selectedFormID:-1}},computed:{...v({user:t=>t.auth.user,is_super_admin:t=>t.auth.is_super_admin,all_data:t=>t.count_forms.all_data,loading:t=>t.count_forms.loading}),filtered_data(){let t=[];return this.all_data.forEach(l=>{l.date.includes("2023-09")&&t.push({...l,no_of_species:l.species_list.length})}),this.selected_status!="all"&&(t=t.filter(l=>l.status==this.selected_status)),t},selected_form(){return this.selectedFormID==-1?{}:this.all_data.find(t=>t.id==this.selectedFormID)}},watch:{},mounted(){b.dispatch("count_forms/getAllData")},methods:{selectForm(t){this.selectedFormID=t,this.showModal=!0},showApproveBtn(t){return t.status=="pending"},showDeleteBtn(t){return t.status!="approved"},async approveForm(t){confirm("Are you sure you want to Approve this Form?")&&await b.dispatch("count_forms/approveForm",t)},async deleteForm(t){confirm("Are you sure you want to delete this Form?")&&await b.dispatch("count_forms/deleteForm",t)},closeModal(){this.selectedForm={},this.showModal=!1}}},ot={class:"text"},at={class:"container-fluid validate-forms-container"},nt={class:"d-flex justify-content-center bg-dark p-2"},lt=["textContent","onClick"],dt={class:"table table-sm"},rt={class:"bg-success text-warning"},it=["textContent"],ct={key:0},ut={class:"table-secondary"},_t=["textContent","onClick"],mt={key:0,class:"bg-secondary d-flex justify-content-around"},ht=["onClick"],ft=["onClick"];function pt(t,l,h,g,r,n){const a=y("ButterflyAnimation"),u=y("modal-show-count-form");return e(),s(i,null,[t.loading?(e(),w(a,{key:0},{default:S(()=>[o("div",ot,m(t.loading),1)]),_:1})):c("",!0),o("div",at,[o("div",nt,[(e(!0),s(i,null,_(r.statuses,d=>(e(),s("button",{key:d,class:p(["btn btn-sm",d==r.selected_status?"btn-success":"btn-outline-success bg-light"]),textContent:m(d),onClick:f=>r.selected_status=d},null,10,lt))),128))]),o("table",dt,[o("thead",rt,[o("tr",null,[(e(!0),s(i,null,_(r.headers,d=>(e(),s("th",{key:d,textContent:m(d)},null,8,it))),128)),t.is_super_admin?(e(),s("th",ct,"Actions")):c("",!0)])]),o("tbody",ut,[(e(!0),s(i,null,_(n.filtered_data,d=>(e(),s("tr",{key:d.id},[(e(!0),s(i,null,_(r.headers,f=>(e(),s("td",{key:f,textContent:m(d[f]),onClick:Ct=>n.selectForm(d.id)},null,8,_t))),128)),t.is_super_admin?(e(),s("td",mt,[n.showApproveBtn(d)?(e(),s("button",{key:0,class:"btn btn-sm btn-success",onClick:f=>n.approveForm(d)}," Approve ",8,ht)):c("",!0),M(" Â  "),n.showDeleteBtn(d)?(e(),s("button",{key:1,class:"btn btn-sm btn-danger",onClick:f=>n.deleteForm(d)}," Delete ",8,ft)):c("",!0)])):c("",!0)]))),128))])])]),A(u,{show:r.showModal,form_data:n.selected_form,onClose:n.closeModal},null,8,["show","form_data","onClose"])],64)}const bt=k(st,[["render",pt],["__scopeId","data-v-4040c67a"]]),C=B({});C.component("ValidateForms",bt);C.use(b);C.mount("#app");

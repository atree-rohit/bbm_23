import{g as y,m as f,e as I,_ as v,c as o,b as t,F as u,j as m,d as r,o as n,t as d,w as c,v as b,q as S,p as g,i as C,s as i,r as j,k as D,f as E}from"./_plugin-vue_export-helper-5496cfb3.js";const L=y({name:"ModalEditUser",props:{show:{type:Boolean,default:!1},data:{type:Object,default:()=>{}}},emits:["close"],data(){return{form_questions:[{type:"text",label:"Name",name:"name",required:!0},{type:"text",label:"Email",name:"email",required:!0},{type:"select",label:"User Type",name:"user_type",required:!0,options:[{label:"User",value:"user"},{label:"Admin",value:"admin"},{label:"Super Admin",value:"super_admin"}]}],form_data:{}}},computed:{...f({auth_user:e=>e.auth.user})},watch:{show(e){this.form_data=this.data;let s=document.querySelector("body");e==!0?s.classList.add("modal-open"):s.classList.remove("modal-open")}},methods:{...I({update:"manage_users/update"}),valueFromLabel(e){return e.replace(/\s/g,"_").toLowerCase()},submit(){let e={form_data:this.form_data,user:this.auth_user};this.update(e),this.closeModal()},closeModal(){this.$emit("close")}}}),$=e=>(g("data-v-5bbb77cb"),e=e(),C(),e),V={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},A={class:"modal-dialog modal-lg"},N={class:"modal-content"},T={class:"modal-header"},B=$(()=>t("h3",{class:"modal-title",id:"exampleModalLiveLabel"},"Edit User Details",-1)),F={class:"modal-body"},P=["for","textContent"],z=["onUpdate:modelValue","placeholder"],O=["onUpdate:modelValue","placeholder"],X=["onUpdate:modelValue","disabled"],Y=$(()=>t("option",null,"Select Link Type",-1)),G=["value","textContent","selected"],H={class:"modal-footer"},J={key:1,class:"modal-backdrop fade show"};function K(e,s,_,w,k,U){return n(),o(u,null,[e.show?(n(),o("div",V,[t("div",A,[t("div",N,[t("div",T,[B,t("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=(...l)=>e.closeModal&&e.closeModal(...l))})]),t("div",F,[t("form",{action:"javascript:void(0)",onSubmit:s[1]||(s[1]=(...l)=>e.submit&&e.submit(...l)),class:"row",method:"post"},[(n(!0),o(u,null,m(e.form_questions,l=>(n(),o("div",{key:l.name,class:"form-group col-12"},[t("label",{for:l.name,class:"font-weight-bold",textContent:d(l.label)},null,8,P),l.type=="text"?c((n(),o("input",{key:0,type:"text","onUpdate:modelValue":a=>e.form_data[l.name]=a,placeholder:`Enter ${l.name}`,class:"form-control"},null,8,z)),[[b,e.form_data[l.name]]]):r("",!0),l.type=="number"?c((n(),o("input",{key:1,type:"number","onUpdate:modelValue":a=>e.form_data[l.name]=a,placeholder:`Enter ${l.name}`,class:"form-control"},null,8,O)),[[b,e.form_data[l.name]]]):l.type=="select"?c((n(),o("select",{key:2,"onUpdate:modelValue":a=>e.form_data[l.name]=a,class:"form-select",disabled:e.auth_user.user_type!="super_admin"||e.auth_user.id==e.data.id},[Y,(n(!0),o(u,null,m(l.options,a=>(n(),o("option",{key:a.value,value:a.value,textContent:d(a.label),selected:a.value=="newspaper_print"},null,8,G))),128))],8,X)),[[S,e.form_data[l.name]]]):r("",!0)]))),128))],32)]),t("div",H,[t("button",{type:"button",class:"btn btn-secondary",onClick:s[2]||(s[2]=(...l)=>e.closeModal&&e.closeModal(...l))},"Close"),t("button",{type:"button",class:"btn btn-success",onClick:s[3]||(s[3]=(...l)=>e.submit&&e.submit(...l))},"Save changes")])])])])):r("",!0),e.show?(n(),o("div",J)):r("",!0)],64)}const Q=v(L,[["render",K],["__scopeId","data-v-5bbb77cb"]]);const R=y({name:"ManageUsers",components:{ModalEditUser:Q},data(){return{show_modal:!1,modal_data:{}}},computed:{...f({auth_user:e=>e.auth.user,is_admin:e=>e.auth.is_admin,is_super_admin:e=>e.auth.is_super_admin,all_users:e=>e.manage_users.all_data,all_logs:e=>e.logs.all_data}),log_table_data(){let e=[];for(let s of this.all_logs)e.push({id:s.id,subject_type:s.subject_type.replace("App\\Models\\",""),subject_id:s.subject_id,causer_id:s.causer_id,event:s.event,properties:s.properties.attributes,created_at:s.created_at,updated_at:s.updated_at});return e.reverse()}},mounted(){i.dispatch("manage_users/getAllData"),i.dispatch("logs/getAllData")},methods:{showModal(e){this.modal_data=e,this.show_modal=!0},getUserName(e){let s=this.all_users.find(_=>_.id==e);return s?s.name:"Unknown"},deleteUser(e){confirm("Are you sure you want to delete this user?")&&i.dispatch("manage_users/delete",e)},pullInat(){i.dispatch("data/pullInat")}}}),p=e=>(g("data-v-7423653c"),e=e(),C(),e),W={key:0,class:"main-container m-4"},Z=p(()=>t("div",{class:"header d-flex px-2"},[t("div",{class:"h1"},"Manage Users")],-1)),x={class:"table table-bordered table-hover"},q=p(()=>t("thead",{class:"bg-info"},[t("tr",null,[t("th",null,"ID"),t("th",null,"Name"),t("th",null,"Email"),t("th",null,"User Type"),t("th",null,"Actions")])],-1)),ee=["onClick"],te={class:"text-center d-flex justify-content-around h4"},ae={key:0,class:"btn btn-primary badge",title:"Edit User"},se=["onClick"],le={class:"w-100"},oe={class:"table table-sm table-hover"},ne=p(()=>t("thead",{class:"bg-secondary text-light"},[t("tr",null,[t("th",null,"ID"),t("th",null,"Subject"),t("th",null,"Subject ID"),t("th",null,"Causer ID"),t("th",null,"Properties"),t("th",null,"Log Type")])],-1)),de={class:"table-secondary"},re=["textContent"],ie=["textContent"],ue=["textContent"],me=["textContent"],_e=["textContent"],ce=["textContent"],pe={key:1,class:"main-container btn-danger d-flex justify-content-center align-items-center",style:{height:"20rem","font-size":"3.5vw","font-weight":"100"}};function he(e,s,_,w,k,U){const l=j("modal-edit-user");return e.is_admin||e.is_super_admin?(n(),o("div",W,[Z,t("table",x,[q,t("tbody",null,[(n(!0),o(u,null,m(e.all_users,a=>(n(),o("tr",{key:a.id,onClick:M=>e.showModal(a)},[t("td",null,d(a.id),1),t("td",null,d(a.name),1),t("td",null,d(a.email),1),t("td",null,d(a.user_type),1),t("td",te,[e.auth_user.id==a.id||e.is_super_admin?(n(),o("span",ae," âœŽ ")):r("",!0),e.auth_user.id!=a.id&&e.is_super_admin?(n(),o("span",{key:1,class:"btn btn-danger badge",onClick:M=>e.deleteUser(a.id),title:"Delete User"}," X ",8,se)):r("",!0)])],8,ee))),128))])]),t("div",le,[t("table",oe,[ne,t("tbody",de,[(n(!0),o(u,null,m(e.log_table_data,a=>(n(),o("tr",{key:a.id},[t("td",{textContent:d(a.id)},null,8,re),t("td",{textContent:d(a.subject_type)},null,8,ie),t("td",{textContent:d(a.subject_id)},null,8,ue),t("td",{textContent:d(e.getUserName(a.causer_id))},null,8,me),t("td",{class:"text-small",textContent:d(a.properties)},null,8,_e),t("td",{textContent:d(a.event)},null,8,ce)]))),128))])])]),D(l,{show:e.show_modal,data:e.modal_data,onClose:s[0]||(s[0]=a=>e.show_modal=!1)},null,8,["show","data"]),t("button",{class:"btn btn-sm btn-danger mb-5",onClick:s[1]||(s[1]=(...a)=>e.pullInat&&e.pullInat(...a))},"Pull Inat")])):(n(),o("div",pe," You Need to be Logged In to View This Page "))}const be=v(R,[["render",he],["__scopeId","data-v-7423653c"]]),h=E({});h.component("manage-users",be);h.use(i);h.mount("#app");

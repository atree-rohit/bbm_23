import{g as y,m as $,e as N,_ as C,r as h,c as l,b as o,F as p,i as _,d as m,o as s,t as c,w as b,v as S,u as F,l as U,p as w,k,j as v,s as V,n as I,x as A}from"./_plugin-vue_export-helper-6122d275.js";import{F as j}from"./FileUploadComponent-1a816f34.js";import{d as D,s as L,M as E}from"./MapComponent-16990228.js";const P=y({name:"ModalAddPartner",props:{show:{type:Boolean,default:!1}},components:{FileUploadComponent:j},emits:["close"],data(){return{form_questions:[{type:"text",label:"Name",name:"name",required:!0},{type:"text",label:"Organization / Designation",name:"designation",required:!1},{type:"select",label:"State",name:"state",required:!0,options:[]},{type:"select",label:"District",name:"district",required:!0,options:[]},{type:"text",label:"Coordinates (Latitude, Longitude)",name:"coordinates",required:!1},{type:"text",label:"Email",name:"email",required:!1},{type:"text",label:"Phone Number",name:"phone",required:!1},{type:"file",label:"Image",name:"image",required:!1}],form_data:{},upload_file_flag:!1}},created(){this.initSelectOptions(),this.initFormData()},watch:{show(e){let t=document.querySelector("body");e==!0?t.classList.add("modal-open"):t.classList.remove("modal-open")}},computed:{...$({user:e=>e.auth.user}),select_district_options(){let e=[];if(this.form_data.state=="-1")e.push({label:"Select State First",value:"-1"});else{e.push({label:"Select District",value:"-1"});let t=[];D.features.map(r=>{this.valueFromLabel(r.properties.state)==this.form_data.state&&t.push({label:r.properties.district.trim(),value:this.valueFromLabel(r.properties.district.trim())})}),e=e.concat(t.sort((r,u)=>r.label<u.label?-1:r.label>u.label?1:0))}return e}},methods:{...N({store:"district_coordinators/store"}),initSelectOptions(){this.form_questions[2].options=L.features.map(e=>({label:e.properties.state.trim(),value:this.valueFromLabel(e.properties.state.trim())})).sort((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)},initFormData(){this.form_data={name:"",designation:"",district:"-1",state:"-1",coordinates:"",email:"",phone:"",image:"",user:this.user}},valueFromLabel(e){return e.replace(/\s/g,"_").toLowerCase()},closeModal(){this.$emit("close")},handleUploadedFileId(e){this.form_data.image=e.data.id;try{this.store(this.form_data),this.initFormData(),this.closeModal(),this.upload_file_flag=!1}catch(t){console.error(t)}},submit(){this.upload_file_flag=!0}}}),B=e=>(w("data-v-774a9898"),e=e(),k(),e),O={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},z={class:"modal-dialog modal-lg"},q={class:"modal-content"},T={class:"modal-header"},X=B(()=>o("h3",{class:"modal-title",id:"exampleModalLiveLabel"},"Add District Coordinator",-1)),G={class:"modal-body"},H=["for","textContent"],J=["onUpdate:modelValue","placeholder"],K=["onUpdate:modelValue","placeholder"],Q=["onUpdate:modelValue"],R={selected:"true",value:"-1"},W=["value","textContent"],Y=["onUpdate:modelValue"],Z=["value","textContent"],x={class:"modal-footer"},ee={key:1,class:"modal-backdrop fade show"};function te(e,t,r,u,f,g){const i=h("file-upload-component");return s(),l(p,null,[e.show?(s(),l("div",O,[o("div",z,[o("div",q,[o("div",T,[X,o("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...a)=>e.closeModal&&e.closeModal(...a))})]),o("div",G,[o("form",{action:"javascript:void(0)",onSubmit:t[1]||(t[1]=(...a)=>e.submit&&e.submit(...a)),class:"row",method:"post"},[(s(!0),l(p,null,_(e.form_questions,a=>(s(),l("div",{key:a.name,class:"form-group col-12"},[o("label",{for:a.name,class:"font-weight-bold",textContent:c(a.label)},null,8,H),a.type=="text"?b((s(),l("input",{key:0,type:"text","onUpdate:modelValue":n=>e.form_data[a.name]=n,placeholder:`Enter ${a.name}`,class:"form-control"},null,8,J)),[[S,e.form_data[a.name]]]):a.type=="textarea"?b((s(),l("textarea",{key:1,"onUpdate:modelValue":n=>e.form_data[a.name]=n,placeholder:`Enter ${a.name}`,class:"form-control"},null,8,K)),[[S,e.form_data[a.name]]]):a.name=="state"?b((s(),l("select",{key:2,"onUpdate:modelValue":n=>e.form_data[a.name]=n,class:"form-select"},[o("option",R,"Select "+c(a.label),1),(s(!0),l(p,null,_(a.options,n=>(s(),l("option",{key:n.value,value:n.value,textContent:c(n.label)},null,8,W))),128))],8,Q)),[[F,e.form_data[a.name]]]):a.name=="district"?b((s(),l("select",{key:3,"onUpdate:modelValue":n=>e.form_data[a.name]=n,class:"form-select"},[(s(!0),l(p,null,_(e.select_district_options,n=>(s(),l("option",{key:n.value,value:n.value,textContent:c(n.label)},null,8,Z))),128))],8,Y)),[[F,e.form_data[a.name]]]):a.type=="file"?(s(),U(i,{key:4,class:"form-control",type:"file",upload_file:e.upload_file_flag,folder:"district_coordinators",onUploaded_file_id:e.handleUploadedFileId},null,8,["upload_file","onUploaded_file_id"])):m("",!0)]))),128))],32)]),o("div",x,[o("button",{type:"button",class:"btn btn-secondary",onClick:t[2]||(t[2]=(...a)=>e.closeModal&&e.closeModal(...a))},"Close"),o("button",{type:"button",class:"btn btn-success",onClick:t[3]||(t[3]=(...a)=>e.submit&&e.submit(...a))},"Save changes")])])])])):m("",!0),e.show?(s(),l("div",ee)):m("",!0)],64)}const oe=C(P,[["render",te],["__scopeId","data-v-774a9898"]]);const ae=y({name:"ModalViewDistrictCoordinators",props:{show:{type:Boolean,default:!1},data:{type:Array,default:()=>[]}},emits:["close"],data(){return{form_questions:[{type:"text",label:"Name",name:"name",required:!0},{type:"text",label:"Organization / Designation",name:"designation",required:!1},{type:"select",label:"State",name:"state",required:!0,options:[]},{type:"select",label:"District",name:"district",required:!0,options:[]},{type:"text",label:"Coordinates (Latitude, Longitude)",name:"coordinates",required:!1},{type:"text",label:"Email",name:"email",required:!1},{type:"text",label:"Phone Number",name:"phone",required:!1},{type:"file",label:"Image",name:"image",required:!1}],current_district_coordinator_id:0}},created(){},watch:{show(e){let t=document.querySelector("body");e==!0?t.classList.add("modal-open"):t.classList.remove("modal-open")}},methods:{valueFromLabel(e){return e.replace(/\s/g,"_").toLowerCase()},closeModal(){this.$emit("close")}}}),se=e=>(w("data-v-8a06ddf1"),e=e(),k(),e),le={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},re={class:"modal-dialog modal-lg"},ie={class:"modal-content"},ne={class:"modal-header"},de=se(()=>o("h3",{class:"modal-title",id:"exampleModalLiveLabel"},"View District Coordinator",-1)),ce={class:"modal-body"},ue={key:0,class:"btn-group mx-auto d-flex justify-content-center"},me={class:"my-0 mx-5 h3"},pe={class:"table"},_e={class:"modal-footer"},he={key:1,class:"modal-backdrop fade show"};function fe(e,t,r,u,f,g){return s(),l(p,null,[e.show?(s(),l("div",le,[o("div",re,[o("div",ie,[o("div",ne,[de,o("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...i)=>e.closeModal&&e.closeModal(...i))})]),o("div",ce,[e.data.length>=1?(s(),l("div",ue,[o("div",null,[e.current_district_coordinator_id>0?(s(),l("button",{key:0,class:"btn btn-outline-secondary",onClick:t[1]||(t[1]=i=>e.current_district_coordinator_id--)}," < ")):m("",!0)]),o("div",me,c(e.current_district_coordinator_id),1),o("div",null,[e.current_district_coordinator_id<e.data.length-1?(s(),l("button",{key:0,class:"btn btn-outline-secondary",onClick:t[2]||(t[2]=i=>e.current_district_coordinator_id++)}," > ")):m("",!0)])])):m("",!0),o("table",pe,[o("tbody",null,[(s(!0),l(p,null,_(e.form_questions,i=>(s(),l("tr",{key:i.name},[o("td",null,c(i.label),1),o("td",null,c(e.data[e.current_district_coordinator_id][i.name]),1)]))),128))])])]),o("div",_e,[o("button",{type:"button",class:"btn btn-secondary",onClick:t[3]||(t[3]=(...i)=>e.closeModal&&e.closeModal(...i))},"Close"),o("button",{type:"button",class:"btn btn-success",onClick:t[4]||(t[4]=(...i)=>e.submit&&e.submit(...i))},"Save changes")])])])])):m("",!0),e.show?(s(),l("div",he)):m("",!0)],64)}const be=C(ae,[["render",fe],["__scopeId","data-v-8a06ddf1"]]);const ve=y({name:"MapDistrictCoordinator",components:{MapComponent:E},emits:["polygon-clicked"],data(){return{geojson:{district:D,state:L},mode:"state"}},computed:{...$({district_coordinators:e=>e.district_coordinators.all_data}),map_data(){let e={states:this.geojson.state.features.map(r=>r.properties.state),districts:this.geojson.district.features.map(r=>r.properties.district)},t={state:e.states.map(r=>({name:r,value:0})),district:e.districts.map(r=>({name:r,value:0}))};return this.district_coordinators.forEach(r=>{t.state.find((u,f)=>r.state==this.valueFromLabel(u.name)).value+=1,t.district.forEach(u=>{r.district==this.valueFromLabel(u.name)&&(u.value+=1)})}),t}},mounted(){},methods:{valueFromLabel(e){return e.replace(/\s/g,"_").toLowerCase()},polygonClick(e){this.$emit("polygon-clicked",e)}}}),ye={class:"map-container border border-danger rounded"};function Ce(e,t,r,u,f,g){const i=h("map-component");return s(),l("div",ye,[v(i,{geojson:e.geojson[e.mode],data:e.map_data,modes:["state","district"],tooltip_third_row_label:"Coordinator(/s)",onModeChange:t[0]||(t[0]=a=>e.mode=a),onPolygonClicked:e.polygonClick},null,8,["geojson","data","onPolygonClicked"])])}const ge=C(ve,[["render",Ce]]);const $e=y({name:"DistrictCoordinators",components:{ModalAddDistrictCoordinator:oe,ModalViewDistrictCoordinators:be,MapDistrictCoordinator:ge},data(){return{show_add_modal:!1,show_view_modal:!1,headers:[{value:"id",label:"Sl. No."},{value:"name",label:"Name"},{value:"state",label:"State"},{value:"district",label:"District"}],sort_col:"id",sort_dir:"asc",selected_district_coordinator:null}},computed:{...$({user:e=>e.auth.user,all_data:e=>e.district_coordinators.all_data}),auth(){return this.user&&(this.user.user_type=="super_admin"||this.user.user_type=="admin")},table_data(){return this.all_data.sort((e,t)=>this.sort_dir=="asc"?e[this.sort_col]>t[this.sort_col]?1:-1:e[this.sort_col]<t[this.sort_col]?1:-1)}},created(){V.dispatch("district_coordinators/getAllData")},methods:{polygonClick(e){let t=this.all_data.filter(r=>r.state==this.valueFromLabel(e.name)||r.district==this.valueFromLabel(e.name));this.selected_district_coordinator=t,this.show_view_modal=!0},showViewModal(e){this.selected_district_coordinator=[e],this.show_view_modal=!0},valueFromLabel(e){return e.replace(/\s/g,"_").toLowerCase()},getStateName(e){var t;return e==-1?"":(t=L.features.find(r=>this.valueFromLabel(r.properties.state)==e))==null?void 0:t.properties.state},getDistrictName(e){var t;return e==-1?"":(t=D.features.find(r=>this.valueFromLabel(r.properties.district)==e))==null?void 0:t.properties.district},headerSortClass(e){if(e==this.sort_col)return this.sort_dir=="asc"?"sort-asc":"sort-desc"},headerClick(e){e==this.sort_col?this.sort_dir=this.sort_dir=="asc"?"desc":"asc":(this.sort_col=e,this.sort_dir="asc")},deleteDistrictCoordinator(e){confirm("Are you sure you want to delete this District Coordinator?")&&V.dispatch("district_coordinators/delete",e)}}}),we=e=>(w("data-v-1de7ffd3"),e=e(),k(),e),ke={class:"container-fluid"},De={class:"header d-flex px-2"},Le=we(()=>o("div",{class:"h1"},"District Coordinators",-1)),Me={key:0},Se={class:"main-container m-4"},Fe={class:"table table-primary"},Ve=["textContent","onClick"],Ne={key:0,class:"bg-warning text-center"},Ue=["onClick"],Ie=["textContent"],Ae=["textContent"],je=["textContent"],Ee=["textContent"],Pe={key:0,class:"table-warning text-center"},Be=["onClick"];function Oe(e,t,r,u,f,g){const i=h("map-district-coordinator"),a=h("modal-view-district-coordinators"),n=h("modal-add-district-coordinator");return s(),l("div",ke,[o("div",De,[Le,e.auth?(s(),l("div",Me,[o("button",{class:"btn btn-lg btn-success mx-5",onClick:t[0]||(t[0]=d=>e.show_add_modal=!0),title:"Add District Coordinator"},"+")])):m("",!0)]),o("div",Se,[o("table",Fe,[o("thead",null,[o("tr",null,[(s(!0),l(p,null,_(e.headers,d=>(s(),l("th",{key:d.value,textContent:c(d.label),class:I(["bg-primary",e.headerSortClass(d.value)]),onClick:M=>e.headerClick(d.value)},null,10,Ve))),128)),e.auth?(s(),l("th",Ne,"Actions")):m("",!0)])]),o("tbody",null,[(s(!0),l(p,null,_(e.table_data,d=>(s(),l("tr",{key:d.id,onClick:M=>e.showViewModal(d)},[o("td",{textContent:c(d.id)},null,8,Ie),o("td",{textContent:c(d.name)},null,8,Ae),o("td",{textContent:c(e.getStateName(d.state))},null,8,je),o("td",{textContent:c(e.getDistrictName(d.district))},null,8,Ee),e.auth?(s(),l("td",Pe,[o("button",{class:"btn delete-btn badge btn-danger",onClick:A(M=>e.deleteDistrictCoordinator(d.id),["stop"]),title:"Delete District Coordinator"}," X ",8,Be)])):m("",!0)],8,Ue))),128))])]),v(i,{onPolygonClicked:e.polygonClick},null,8,["onPolygonClicked"]),v(a,{show:e.show_view_modal,data:e.selected_district_coordinator,onClose:t[1]||(t[1]=d=>e.show_view_modal=!1)},null,8,["show","data"])]),v(n,{show:e.show_add_modal,onClose:t[2]||(t[2]=d=>e.show_add_modal=!1)},null,8,["show"])])}const Xe=C($e,[["render",Oe],["__scopeId","data-v-1de7ffd3"]]);export{Xe as D};

import{i as y,m as f,f as M,_ as v,c as o,b as t,F as _,l as p,d as u,o as n,t as d,g as c,v as b,y as S,p as g,k,z as A,s as i,r as D,e as j,j as V,h as E}from"./_plugin-vue_export-helper-9c210362.js";const L=y({name:"ModalEditUser",props:{show:{type:Boolean,default:!1},data:{type:Object,default:()=>{}}},emits:["close"],data(){return{form_questions:[{type:"text",label:"Name",name:"name",required:!0},{type:"text",label:"Email",name:"email",required:!0},{type:"select",label:"User Type",name:"user_type",required:!0,options:[{label:"User",value:"user"},{label:"Admin",value:"admin"},{label:"Super Admin",value:"super_admin"}]}],form_data:{}}},computed:{...f({auth_user:e=>e.auth.user})},watch:{show(e){this.form_data=this.data;let s=document.querySelector("body");e==!0?s.classList.add("modal-open"):s.classList.remove("modal-open")}},methods:{...M({update:"manage_users/update"}),valueFromLabel(e){return e.replace(/\s/g,"_").toLowerCase()},submit(){let e={form_data:this.form_data,user:this.auth_user};this.update(e),this.closeModal()},closeModal(){this.$emit("close")}}}),w=e=>(g("data-v-5bbb77cb"),e=e(),k(),e),N={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},P={class:"modal-dialog modal-lg"},T={class:"modal-content"},K={class:"modal-header"},B=w(()=>t("h3",{class:"modal-title",id:"exampleModalLiveLabel"},"Edit User Details",-1)),F={class:"modal-body"},z=["for","textContent"],G=["onUpdate:modelValue","placeholder"],O=["onUpdate:modelValue","placeholder"],X=["onUpdate:modelValue","disabled"],Y=w(()=>t("option",null,"Select Link Type",-1)),H=["value","textContent","selected"],J={class:"modal-footer"},Q={key:1,class:"modal-backdrop fade show"};function R(e,s,m,C,$,U){return n(),o(_,null,[e.show?(n(),o("div",N,[t("div",P,[t("div",T,[t("div",K,[B,t("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=(...l)=>e.closeModal&&e.closeModal(...l))})]),t("div",F,[t("form",{action:"javascript:void(0)",onSubmit:s[1]||(s[1]=(...l)=>e.submit&&e.submit(...l)),class:"row",method:"post"},[(n(!0),o(_,null,p(e.form_questions,l=>(n(),o("div",{key:l.name,class:"form-group col-12"},[t("label",{for:l.name,class:"font-weight-bold",textContent:d(l.label)},null,8,z),l.type=="text"?c((n(),o("input",{key:0,type:"text","onUpdate:modelValue":a=>e.form_data[l.name]=a,placeholder:`Enter ${l.name}`,class:"form-control"},null,8,G)),[[b,e.form_data[l.name]]]):u("",!0),l.type=="number"?c((n(),o("input",{key:1,type:"number","onUpdate:modelValue":a=>e.form_data[l.name]=a,placeholder:`Enter ${l.name}`,class:"form-control"},null,8,O)),[[b,e.form_data[l.name]]]):l.type=="select"?c((n(),o("select",{key:2,"onUpdate:modelValue":a=>e.form_data[l.name]=a,class:"form-select",disabled:e.auth_user.user_type!="super_admin"||e.auth_user.id==e.data.id},[Y,(n(!0),o(_,null,p(l.options,a=>(n(),o("option",{key:a.value,value:a.value,textContent:d(a.label),selected:a.value=="newspaper_print"},null,8,H))),128))],8,X)),[[S,e.form_data[l.name]]]):u("",!0)]))),128))],32)]),t("div",J,[t("button",{type:"button",class:"btn btn-secondary",onClick:s[2]||(s[2]=(...l)=>e.closeModal&&e.closeModal(...l))},"Close"),t("button",{type:"button",class:"btn btn-success",onClick:s[3]||(s[3]=(...l)=>e.submit&&e.submit(...l))},"Save changes")])])])])):u("",!0),e.show?(n(),o("div",Q)):u("",!0)],64)}const W=v(L,[["render",R],["__scopeId","data-v-5bbb77cb"]]);const Z=y({name:"ManageUsers",components:{ModalEditUser:W},data(){return{show_modal:!1,modal_data:{},a_key_pressed:!1}},computed:{...f({auth_user:e=>e.auth.user,is_admin:e=>e.auth.is_admin,is_super_admin:e=>e.auth.is_super_admin,all_users:e=>e.manage_users.all_data,all_logs:e=>e.logs.all_data}),...A({inat_new_total:"data/inat_new_total"}),log_table_data(){let e=[];for(let s of this.all_logs)e.push({id:s.id,subject_type:s.subject_type.replace("App\\Models\\",""),subject_id:s.subject_id,causer_id:s.causer_id,event:s.event,properties:s.properties.attributes,created_at:s.created_at,updated_at:s.updated_at});return e.reverse()}},mounted(){i.dispatch("data/initInatPull"),i.dispatch("manage_users/getAllData"),i.dispatch("logs/getAllData")},methods:{showModal(e){this.modal_data=e,this.show_modal=!0},getUserName(e){let s=this.all_users.find(m=>m.id==e);return s?s.name:"Unknown"},deleteUser(e){confirm("Are you sure you want to delete this user?")&&i.dispatch("manage_users/delete",e)},pullInat(){let e=!1;i.dispatch("data/pullInat",e)},pullInatAll(e){if(e.key==="a"&&this.a_key_pressed==!1){let s=!0;i.dispatch("data/pullInat",s),this.a_key_pressed=!0}},resetAKeyPressed(){this.a_key_pressed=!1},addStoredData(){i.dispatch("data/addStoredData")}}}),r=e=>(g("data-v-3ea57d48"),e=e(),k(),e),x={key:0,class:"main-container m-4"},q=r(()=>t("div",{class:"header d-flex px-2"},[t("div",{class:"h1"},"Manage Users")],-1)),ee={class:"table table-bordered table-hover"},te=r(()=>t("thead",{class:"bg-info"},[t("tr",null,[t("th",null,"ID"),t("th",null,"Name"),t("th",null,"Email"),t("th",null,"User Type"),t("th",null,"Actions")])],-1)),ae=["onClick"],se={class:"text-center d-flex justify-content-around h4"},le={key:0,class:"btn btn-primary badge",title:"Edit User"},oe=["onClick"],ne={class:"w-100 log-table-container"},de={class:"table table-sm table-hover"},re=r(()=>t("thead",{class:"bg-secondary text-light"},[t("tr",null,[t("th",null,"ID"),t("th",null,"Subject"),t("th",null,"Subject ID"),t("th",null,"Causer ID"),t("th",null,"Properties"),t("th",null,"Log Type")])],-1)),ie={class:"table-secondary"},ue=["textContent"],_e=["textContent"],pe=["textContent"],me=["textContent"],ce=["textContent"],he=["textContent"],be=r(()=>t("br",null,null,-1)),ye=r(()=>t("hr",null,null,-1)),fe=r(()=>t("br",null,null,-1)),ve=r(()=>t("br",null,null,-1)),ge=r(()=>t("hr",null,null,-1)),ke=r(()=>t("br",null,null,-1)),we={key:0,class:"w-100 d-flex justify-content-center py-3 my-2 border border-danger"},Ce={key:1,class:"main-container btn-danger d-flex justify-content-center align-items-center",style:{height:"20rem","font-size":"3.5vw","font-weight":"100"}};function $e(e,s,m,C,$,U){const l=D("modal-edit-user");return e.is_admin||e.is_super_admin?(n(),o("div",x,[q,t("table",ee,[te,t("tbody",null,[(n(!0),o(_,null,p(e.all_users,a=>(n(),o("tr",{key:a.id,onClick:I=>e.showModal(a)},[t("td",null,d(a.id),1),t("td",null,d(a.name),1),t("td",null,d(a.email),1),t("td",null,d(a.user_type),1),t("td",se,[e.auth_user.id==a.id||e.is_super_admin?(n(),o("span",le," âœŽ ")):u("",!0),e.auth_user.id!=a.id&&e.is_super_admin?(n(),o("span",{key:1,class:"btn btn-danger badge",onClick:I=>e.deleteUser(a.id),title:"Delete User"}," X ",8,oe)):u("",!0)])],8,ae))),128))])]),t("div",ne,[t("table",de,[re,t("tbody",ie,[(n(!0),o(_,null,p(e.log_table_data,a=>(n(),o("tr",{key:a.id},[t("td",{textContent:d(a.id)},null,8,ue),t("td",{textContent:d(a.subject_type)},null,8,_e),t("td",{textContent:d(a.subject_id)},null,8,pe),t("td",{textContent:d(e.getUserName(a.causer_id))},null,8,me),t("td",{class:"text-small",textContent:d(a.properties)},null,8,ce),t("td",{textContent:d(a.event)},null,8,he)]))),128))])])]),j(l,{show:e.show_modal,data:e.modal_data,onClose:s[0]||(s[0]=a=>e.show_modal=!1)},null,8,["show","data"]),be,ye,fe,V(" "+d(e.inat_new_total)+" ",1),ve,ge,ke,e.is_super_admin?(n(),o("div",we,[t("button",{class:"btn btn-sm btn-outline-secondary mx-3",onClick:s[1]||(s[1]=(...a)=>e.pullInat&&e.pullInat(...a)),onKeydown:s[2]||(s[2]=(...a)=>e.pullInatAll&&e.pullInatAll(...a)),onKeyup:s[3]||(s[3]=(...a)=>e.resetAKeyPressed&&e.resetAKeyPressed(...a))},"Pull Inat ("+d(e.inat_new_total)+")",33),t("button",{class:"btn btn-sm btn-danger mx-3",onClick:s[4]||(s[4]=(...a)=>e.addStoredData&&e.addStoredData(...a))},"addStoredData")])):u("",!0)])):(n(),o("div",Ce," You Need to be Logged In to View This Page "))}const Ue=v(Z,[["render",$e],["__scopeId","data-v-3ea57d48"]]),h=E({});h.component("manage-users",Ue);h.use(i);h.mount("#app");

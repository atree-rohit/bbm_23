import{g as y,m as f,e as M,_ as v,c as o,b as t,F as u,r as p,d as i,o as n,t as d,w as m,v as b,y as S,p as g,i as k,s as r,l as A,q as j,f as D}from"./_plugin-vue_export-helper-3ebfec0a.js";const E=y({name:"ModalEditUser",props:{show:{type:Boolean,default:!1},data:{type:Object,default:()=>{}}},emits:["close"],data(){return{form_questions:[{type:"text",label:"Name",name:"name",required:!0},{type:"text",label:"Email",name:"email",required:!0},{type:"select",label:"User Type",name:"user_type",required:!0,options:[{label:"User",value:"user"},{label:"Admin",value:"admin"},{label:"Super Admin",value:"super_admin"}]}],form_data:{}}},computed:{...f({auth_user:e=>e.auth.user})},watch:{show(e){this.form_data=this.data;let a=document.querySelector("body");e==!0?a.classList.add("modal-open"):a.classList.remove("modal-open")}},methods:{...M({update:"manage_users/update"}),valueFromLabel(e){return e.replace(/\s/g,"_").toLowerCase()},submit(){let e={form_data:this.form_data,user:this.auth_user};this.update(e),this.closeModal()},closeModal(){this.$emit("close")}}}),w=e=>(g("data-v-5bbb77cb"),e=e(),k(),e),L={key:0,class:"modal fade show","aria-modal":"true",role:"dialog"},V={class:"modal-dialog modal-lg"},N={class:"modal-content"},P={class:"modal-header"},T=w(()=>t("h3",{class:"modal-title",id:"exampleModalLiveLabel"},"Edit User Details",-1)),K={class:"modal-body"},B=["for","textContent"],F=["onUpdate:modelValue","placeholder"],z=["onUpdate:modelValue","placeholder"],O=["onUpdate:modelValue","disabled"],X=w(()=>t("option",null,"Select Link Type",-1)),Y=["value","textContent","selected"],G={class:"modal-footer"},H={key:1,class:"modal-backdrop fade show"};function J(e,a,_,C,$,U){return n(),o(u,null,[e.show?(n(),o("div",L,[t("div",V,[t("div",N,[t("div",P,[T,t("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=(...l)=>e.closeModal&&e.closeModal(...l))})]),t("div",K,[t("form",{action:"javascript:void(0)",onSubmit:a[1]||(a[1]=(...l)=>e.submit&&e.submit(...l)),class:"row",method:"post"},[(n(!0),o(u,null,p(e.form_questions,l=>(n(),o("div",{key:l.name,class:"form-group col-12"},[t("label",{for:l.name,class:"font-weight-bold",textContent:d(l.label)},null,8,B),l.type=="text"?m((n(),o("input",{key:0,type:"text","onUpdate:modelValue":s=>e.form_data[l.name]=s,placeholder:`Enter ${l.name}`,class:"form-control"},null,8,F)),[[b,e.form_data[l.name]]]):i("",!0),l.type=="number"?m((n(),o("input",{key:1,type:"number","onUpdate:modelValue":s=>e.form_data[l.name]=s,placeholder:`Enter ${l.name}`,class:"form-control"},null,8,z)),[[b,e.form_data[l.name]]]):l.type=="select"?m((n(),o("select",{key:2,"onUpdate:modelValue":s=>e.form_data[l.name]=s,class:"form-select",disabled:e.auth_user.user_type!="super_admin"||e.auth_user.id==e.data.id},[X,(n(!0),o(u,null,p(l.options,s=>(n(),o("option",{key:s.value,value:s.value,textContent:d(s.label),selected:s.value=="newspaper_print"},null,8,Y))),128))],8,O)),[[S,e.form_data[l.name]]]):i("",!0)]))),128))],32)]),t("div",G,[t("button",{type:"button",class:"btn btn-secondary",onClick:a[2]||(a[2]=(...l)=>e.closeModal&&e.closeModal(...l))},"Close"),t("button",{type:"button",class:"btn btn-success",onClick:a[3]||(a[3]=(...l)=>e.submit&&e.submit(...l))},"Save changes")])])])])):i("",!0),e.show?(n(),o("div",H)):i("",!0)],64)}const Q=v(E,[["render",J],["__scopeId","data-v-5bbb77cb"]]);const R=y({name:"ManageUsers",components:{ModalEditUser:Q},data(){return{show_modal:!1,modal_data:{},a_key_pressed:!1}},computed:{...f({auth_user:e=>e.auth.user,is_admin:e=>e.auth.is_admin,is_super_admin:e=>e.auth.is_super_admin,all_users:e=>e.manage_users.all_data,all_logs:e=>e.logs.all_data}),log_table_data(){let e=[];for(let a of this.all_logs)e.push({id:a.id,subject_type:a.subject_type.replace("App\\Models\\",""),subject_id:a.subject_id,causer_id:a.causer_id,event:a.event,properties:a.properties.attributes,created_at:a.created_at,updated_at:a.updated_at});return e.reverse()}},mounted(){r.dispatch("manage_users/getAllData"),r.dispatch("logs/getAllData")},methods:{showModal(e){this.modal_data=e,this.show_modal=!0},getUserName(e){let a=this.all_users.find(_=>_.id==e);return a?a.name:"Unknown"},deleteUser(e){confirm("Are you sure you want to delete this user?")&&r.dispatch("manage_users/delete",e)},pullInat(){let e=!1;r.dispatch("data/pullInat",e)},pullInatAll(e){if(e.key==="a"&&this.a_key_pressed==!1){let a=!0;r.dispatch("data/pullInat",a),this.a_key_pressed=!0}},resetAKeyPressed(){this.a_key_pressed=!1},addStoredData(){r.dispatch("data/addStoredData")}}}),c=e=>(g("data-v-99e40a48"),e=e(),k(),e),W={key:0,class:"main-container m-4"},Z=c(()=>t("div",{class:"header d-flex px-2"},[t("div",{class:"h1"},"Manage Users")],-1)),x={class:"table table-bordered table-hover"},q=c(()=>t("thead",{class:"bg-info"},[t("tr",null,[t("th",null,"ID"),t("th",null,"Name"),t("th",null,"Email"),t("th",null,"User Type"),t("th",null,"Actions")])],-1)),ee=["onClick"],te={class:"text-center d-flex justify-content-around h4"},se={key:0,class:"btn btn-primary badge",title:"Edit User"},ae=["onClick"],le={class:"w-100 log-table-container"},oe={class:"table table-sm table-hover"},ne=c(()=>t("thead",{class:"bg-secondary text-light"},[t("tr",null,[t("th",null,"ID"),t("th",null,"Subject"),t("th",null,"Subject ID"),t("th",null,"Causer ID"),t("th",null,"Properties"),t("th",null,"Log Type")])],-1)),de={class:"table-secondary"},re=["textContent"],ie=["textContent"],ue=["textContent"],pe=["textContent"],_e=["textContent"],me=["textContent"],ce={key:0,class:"w-100 d-flex justify-content-center py-3 my-2 border border-danger"},he={key:1,class:"main-container btn-danger d-flex justify-content-center align-items-center",style:{height:"20rem","font-size":"3.5vw","font-weight":"100"}};function be(e,a,_,C,$,U){const l=A("modal-edit-user");return e.is_admin||e.is_super_admin?(n(),o("div",W,[Z,t("table",x,[q,t("tbody",null,[(n(!0),o(u,null,p(e.all_users,s=>(n(),o("tr",{key:s.id,onClick:I=>e.showModal(s)},[t("td",null,d(s.id),1),t("td",null,d(s.name),1),t("td",null,d(s.email),1),t("td",null,d(s.user_type),1),t("td",te,[e.auth_user.id==s.id||e.is_super_admin?(n(),o("span",se," âœŽ ")):i("",!0),e.auth_user.id!=s.id&&e.is_super_admin?(n(),o("span",{key:1,class:"btn btn-danger badge",onClick:I=>e.deleteUser(s.id),title:"Delete User"}," X ",8,ae)):i("",!0)])],8,ee))),128))])]),t("div",le,[t("table",oe,[ne,t("tbody",de,[(n(!0),o(u,null,p(e.log_table_data,s=>(n(),o("tr",{key:s.id},[t("td",{textContent:d(s.id)},null,8,re),t("td",{textContent:d(s.subject_type)},null,8,ie),t("td",{textContent:d(s.subject_id)},null,8,ue),t("td",{textContent:d(e.getUserName(s.causer_id))},null,8,pe),t("td",{class:"text-small",textContent:d(s.properties)},null,8,_e),t("td",{textContent:d(s.event)},null,8,me)]))),128))])])]),j(l,{show:e.show_modal,data:e.modal_data,onClose:a[0]||(a[0]=s=>e.show_modal=!1)},null,8,["show","data"]),e.is_super_admin?(n(),o("div",ce,[t("button",{class:"btn btn-sm btn-outline-secondary mx-3",onClick:a[1]||(a[1]=(...s)=>e.pullInat&&e.pullInat(...s)),onKeydown:a[2]||(a[2]=(...s)=>e.pullInatAll&&e.pullInatAll(...s)),onKeyup:a[3]||(a[3]=(...s)=>e.resetAKeyPressed&&e.resetAKeyPressed(...s))},"Pull Inat",32)])):i("",!0)])):(n(),o("div",he," You Need to be Logged In to View This Page "))}const ye=v(R,[["render",be],["__scopeId","data-v-99e40a48"]]),h=D({});h.component("manage-users",ye);h.use(r);h.mount("#app");
